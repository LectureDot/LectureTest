import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/comment/comment.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/lint/json-lint.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/markdown/markdown.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/javascript/javascript.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/python/python.min.js";import{importStyleSheet}from"./common.js";import styles from"./editor.css"with{type:"css"};document.adoptedStyleSheets.push(styles),importStyleSheet("https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css");export const EDITOR_LANGUAGES={text:"text/plain",python:"python",javascript:"javascript",java:"java",c:"clike",json:"application/json",markdown:"markdown",html:"htmlmixed"};let clipboard="";export function codeEditor(e,t,o){const r={mode:"text/plain",lineNumbers:!0,theme:"default",tabSize:2,smartIndent:!0,insertSoftTab:!0,extraKeys:{"Ctrl-/":"toggleComment","Ctrl-C":e=>(clipboard=e.getSelection(),console.log("copy",clipboard),!0),"Ctrl-V":e=>(e.replaceSelection(clipboard),!0),"Ctrl-X":e=>(clipboard=e.getSelection(),e.replaceSelection(""),console.log("copy",clipboard),!0),"Shift-Tab":"indentLess"}};e.tabSize&&(r.tabSize=e.tabSize,delete e.tabSize),e.lang&&(r.mode=EDITOR_LANGUAGES[e.lang]||"text/plain",delete e.lang),void 0!==e.lineNumbers&&(r.lineNumbers=e.lineNumbers,delete e.lineNumbers),void 0!==e.lineWrapping&&(r.lineWrapping=e.lineWrapping,delete e.lineWrapping);const i=CodeMirror(t,r),l=i.getWrapperElement();if(window.cm=i,window.cme=l,Object.defineProperty(l,"value",{set:function(e){i&&"string"==typeof e&&i.setValue(e)},get:function(){return i?i.getValue():""},enumerable:!0,configurable:!0}),l.setOption=(e,t)=>i.setOption(e,t),l.on=i.on,e.class&&(l.classList.add(...e.class.split(" ")),delete e.class),e.style){for(let t in e.style)l.style[t]=e.style[t];delete e.style}for(let t in e)void 0!==l[t]?l[t]=e[t]:l.setAttribute(t,e[t]);return o&&t.prepend(l),setTimeout((()=>i.refresh()),100),l}