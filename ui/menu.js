import{newEl,isArr,isElement}from"./common.js";import styles from"./menu.css"with{type:"css"};document.adoptedStyleSheets.push(styles);export function menu(t,e,n={},o,i){const s=newEl(n,document.body);s.classList.add("menu"),s.close=function(){setTimeout((()=>{s.remove(),window.removeEventListener("mouseup",s.close),window.removeEventListener("keydown",s.close),window.removeEventListener("popstate",s.close)}),100)},isArr(t)||(t=[t]),isArr(e)||(e=[e]);for(let n=0;n<t.length;n++){const o=t[n],i=e[n];let l=isElement(o)?s.appendChild(o):newEl({innerHTML:o},s);i&&(l.addEventListener("mouseup",i),l.classList.add("clickable"))}const l=i?.includes("bottom")?"bottom":i?.includes("top")?"top":"",d=i?.includes("right")?"right":i?.includes("left")?"left":"";if(o||(o=document.activeElement),isArr(o))"left"===d?s.style.left=o[0]+"px":"right"===d?s.style.right=o[0]+"px":o[0]>window.innerWidth/2?s.style.right=window.innerWidth-o[0]+"px":s.style.left=o[0]+"px","top"===l?s.style.top=o[1]+"px":"bottom"===l?s.style.bottom=o[1]+"px":o[1]>window.innerHeight/2?s.style.bottom=window.innerHeight-o[1]+"px":s.style.top=o[1]+"px";else if(isElement(o)){const t=o.getBoundingClientRect();"left"===d?(s.style.left=t.left+"px",s.style.minWidth=t.width+"px"):"right"===d||t.left>window.innerWidth/2?s.style.right=window.innerWidth-t.right+"px":(s.style.left=t.left+"px",s.style.minWidth=t.width+"px"),"top"===l?s.style.top=t.bottom+"px":"bottom"===l||t.top>window.innerHeight/2?s.style.bottom=window.innerHeight-t.top+"px":s.style.top=t.bottom+"px"}return setTimeout((()=>{window.addEventListener("mouseup",s.close),window.addEventListener("keydown",s.close),window.addEventListener("popstate",s.close)}),200),s}