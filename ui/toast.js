import{isObj,show,hide,newEl,isDisplayed,copyToClipboard,span}from"./common.js";import styles from"./toast.css"with{type:"css"};document.adoptedStyleSheets.push(styles);const toastDiv=newEl({id:"toast",className:"hidden"},document.body),toastMsg=span({},toastDiv),toastCopyBtn=newEl({innerHTML:'<i class="fa-solid fa-clipboard"></i>',onmousedown:t=>{t.stopPropagation(),copyToClipboard(toastMsg.textContent),toastCopyBtn.innerHTML='<i class="fa-solid fa-clipboard-check"></i>',toastCopyBtn.classList.add("pulse-once"),setTimeout((()=>toastCopyBtn.classList.remove("pulse-once")),500)}},toastDiv);function closeToast(){window.removeEventListener("mousedown",closeToast),window.removeEventListener("keydown",closeToast),window.removeEventListener("popstate",closeToast),hide(toastDiv),toastDiv.classList.remove("slide-up")}export function toast(t,s,o){if(isDisplayed(toastDiv)&&closeToast(),toastDiv.classList.remove("truncated"),o?toastDiv.style.setProperty("--toast-accent",o>0?"#4f6":o<-.5?"#f64":"#fe4"):toastDiv.style.setProperty("--toast-accent","gray"),toastMsg.innerHTML=s?s+"\n\n":"",isObj(t))for(let s in t)t[s]&&(toastMsg.innerHTML+=s+" : "+t[s]+"\n");else toastMsg.innerHTML+=t;setTimeout((()=>{show(toastDiv),toastDiv.classList.add("slide-up"),toastDiv.scrollHeight>toastDiv.offsetHeight?toastDiv.classList.add("truncated"):toastDiv.classList.remove("truncated")}),10),setTimeout((()=>{window.addEventListener("mousedown",closeToast),window.addEventListener("keydown",closeToast),window.addEventListener("popstate",closeToast)}),200)}export function toastSuccess(t,s){toast(t,s,1)}export function toastWarn(t){toast(t,"Warning",-.1)}export function toastError(t){toast(t,"Error",-1)}window.toast=toast;