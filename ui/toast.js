import{isObj,show,hide,newEl,isDisplayed,copyToClipboard,span,importStyleSheet}from"./common.js";importStyleSheet("./toast.css",import.meta.url);const toastDiv=newEl({id:"toast",className:"hidden"},document.body),toastMsg=span({},toastDiv),toastCopyBtn=newEl({innerHTML:'<i class="fa-solid fa-clipboard"></i>',onmousedown:t=>{t.stopPropagation(),copyToClipboard(toastMsg.textContent),toastCopyBtn.innerHTML='<i class="fa-solid fa-clipboard-check"></i>',toastCopyBtn.classList.add("pulse-once"),setTimeout((()=>toastCopyBtn.classList.remove("pulse-once")),500)}},toastDiv);function closeToast(){window.removeEventListener("mousedown",closeToast),window.removeEventListener("keydown",closeToast),window.removeEventListener("popstate",closeToast),hide(toastDiv),toastDiv.classList.remove("slide-up")}let toastTimeout;export function toast(t,o,s){if(clearTimeout(toastTimeout),isDisplayed(toastDiv)&&closeToast(),toastDiv.classList.remove("truncated"),s?toastDiv.style.setProperty("--toast-accent",s>0?"#4f6":s<-.5?"#f64":"#fe4"):toastDiv.style.setProperty("--toast-accent","gray"),toastMsg.innerHTML=o?o+"\n\n":"",isObj(t))for(let o in t)t[o]&&(toastMsg.innerHTML+=o+" : "+t[o]+"\n");else toastMsg.innerHTML+=t;toastTimeout=setTimeout((()=>{show(toastDiv),toastDiv.classList.add("slide-up"),toastDiv.scrollHeight>toastDiv.offsetHeight?toastDiv.classList.add("truncated"):toastDiv.classList.remove("truncated"),setTimeout((()=>{window.addEventListener("mousedown",closeToast),window.addEventListener("keydown",closeToast),window.addEventListener("popstate",closeToast)}),200)}),50)}export function toastSuccess(t,o){toast(t,o,1)}export function toastWarn(t){toast(t,"Warning",-.1)}export function toastError(t){toast(t,"Error",-1)}window.toast=toast;