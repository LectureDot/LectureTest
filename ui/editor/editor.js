import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/comment/comment.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/addon/lint/json-lint.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/markdown/markdown.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/javascript/javascript.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/python/python.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/htmlmixed/htmlmixed.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/xml/xml.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/css/css.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/clike/clike.min.js";import"https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/sql/sql.min.js";import"./regex.js";import"./reread.js";import{importStyleSheet}from"../common.js";import styles from"./editor.css"with{type:"css"};document.adoptedStyleSheets.push(styles),importStyleSheet("https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.css"),CodeMirror.modeInitFunctions||(CodeMirror.modeInitFunctions={});export const EDITOR_LANGUAGES={text:"text/plain",python:"python",javascript:"javascript",java:"java",c:"clike",sql:"sql",json:"application/json",markdown:"markdown",html:"htmlmixed",regex:"regex",reread:"reread"};let clipboard="";export function codeEditor(e,t,o){const r={mode:"text/plain",lineNumbers:!0,theme:"default",tabSize:2,indentUnit:2,indentWithTabs:!1,smartIndent:!0,insertSoftTab:!0,lineWrapping:!0,readOnly:!1,extraKeys:{"Ctrl-/":"toggleComment","Ctrl-C":e=>(clipboard=e.getSelection(),!0),"Ctrl-V":e=>(e.replaceSelection(clipboard),!0),"Ctrl-X":e=>(clipboard=e.getSelection(),e.replaceSelection(""),!0),Tab:"indentMore","Shift-Tab":"indentLess"}};e.lang&&(r.mode=EDITOR_LANGUAGES[e.lang]||e.lang,delete e.lang);for(let t in e)void 0!==r[t]&&(r[t]=e[t],delete e[t]);const i=CodeMirror(t,r),n=i.getWrapperElement();if(o&&t.prepend(n),n.cm=i,Object.defineProperty(n,"value",{set:function(e){i&&"string"==typeof e&&i.setValue(e)},get:function(){return i?i.getValue():""},enumerable:!0,configurable:!0}),n.setOption=(e,t)=>i.setOption(e,t),n.on=(e,t)=>i.on(e,t),n.getSelection=()=>i.getSelection(),n.insert=n.replaceSelection=e=>i.replaceSelection(e),n.surround=(e,t)=>i.replaceSelection(e+i.getSelection()+t),n.refresh=()=>i.refresh(),n.focus=()=>i.focus(),e.class&&(n.classList.add(...e.class.split(" ")),delete e.class),e.style){for(let t in e.style)n.style[t]=e.style[t];delete e.style}else n.style.height="min( 10em, 100% )",n.style.minHeight="5em";for(let t in e)void 0!==n[t]?n[t]=e[t]:n.setAttribute(t,e[t]);function s(e){const t=e.getOption("mode");CodeMirror.modeInitFunctions[t]&&CodeMirror.modeInitFunctions[t](e)}return s(i),i.on("optionChange",((e,t)=>{"mode"===t&&s(cm)})),setTimeout((()=>i.refresh()),100),n}