import{addElementTo,button,importStyleSheet,isArr,isStr,last,span}from"./common.js";import styles from"./popup.css"with{type:"css"};document.adoptedStyleSheets.push(styles);var popups=[];export function popup(e,s,t,o,n,p={}){p?.className?p.className+=" popup":p.className="popup",Object.assign(p,{tag:"dialog"});const a=addElementTo(document.body,p);return a.addEventListener("cancel",(e=>e.preventDefault())),popups.push(a),a._close=a.close,a.close=()=>{a.onDismiss&&a.onDismiss()||(popups=popups.filter((e=>e!==a)),a._close(),a.remove())},a.header=addElementTo(a,{tag:"h3"}),a.main=addElementTo(a),a.footer=addElementTo(a),a.onDismiss=n,isArr(e)||(e=[e]),isArr(s)||(s=[s]),isArr(t)||(t=[t]),e.forEach((e=>e&&a.header.appendChild(isStr(e)?span({innerHTML:e}):e))),s.forEach((e=>e&&a.main.appendChild(isStr(e)?span({innerHTML:e}):e))),t.forEach((e=>e&&a.footer.appendChild(isStr(e)?span({innerHTML:e}):e))),o&&(a.dismissBtn=addElementTo(a.footer,{tag:"button",textContent:o,events:{click:e=>a.close()}})),a.showModal(),a}export function confirmPopup(e,s,t,o,n,p){const a=popup(e,s,button({textContent:t,events:{click:e=>{o(),a.close()}}}),n,p);return a}function handleEscape(e){if("Escape"===e.key){e.preventDefault();const s=last(popups);s.dismissBtn&&s.close()}}document.addEventListener("keyup",handleEscape);