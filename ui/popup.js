import{newEl,button,isArr,isStr,span,isElement}from"./common.js";import styles from"./popup.css"with{type:"css"};document.adoptedStyleSheets.push(styles);var popups=[];export function popup(e,s,o,t,n,p={},i={}){i.className?p.className+=" modal":i.className="modal",Object.assign(i,{tag:"div"});const r=newEl(i,document.body),l=newEl(p,r);return popups.push(l),l.forceClose=()=>{popups=popups.filter((e=>e!==l)),r.remove()},l.close=()=>{if(l.onDismiss&&l.onDismiss())return!0;l.forceClose()},l.header=newEl({tag:"h3"},l),l.main=newEl({},l),l.footer=newEl({},l),l.onDismiss=n,isArr(e)||(e=[e]),isArr(s)||(s=[s]),isArr(o)||(o=[o]),e.forEach((e=>e&&l.header.appendChild(isElement(e)?e:newEl(e)))),s.forEach((e=>e&&l.main.appendChild(isElement(e)?e:newEl(e)))),o.forEach((e=>e&&l.footer.appendChild(isElement(e)?e:newEl(e)))),t&&(l.dismissBtn=button({textContent:t,events:{click:e=>l.close()}},l.footer)),l}export function confirmPopup(e,s,o,t,n,p){const i=popup(e,s,button({textContent:o,events:{click:e=>{t(),i.close()}}}),n,p);return i}function handleEscapeUp(e){if("Escape"===e.key){const e=popups.at(-1);e?.dismissBtn&&e.close()}}document.addEventListener("keyup",handleEscapeUp);