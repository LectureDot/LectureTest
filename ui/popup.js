import{newEl,button,isArr,isStr,span}from"./common.js";import styles from"./popup.css"with{type:"css"};document.adoptedStyleSheets.push(styles);var popups=[];export function popup(e,s,n,o,t,p={},r={}){r.className?p.className+=" modal":r.className="modal",Object.assign(r,{tag:"div"});const i=newEl(r,document.body),a=newEl(p,i);return popups.push(a),a.forceClose=()=>{popups=popups.filter((e=>e!==a)),i.remove()},a.close=()=>{if(a.onDismiss&&a.onDismiss())return!0;a.forceClose()},a.header=newEl({tag:"h3"},a),a.main=newEl({},a),a.footer=newEl({},a),a.onDismiss=t,isArr(e)||(e=[e]),isArr(s)||(s=[s]),isArr(n)||(n=[n]),e.forEach((e=>e&&a.header.appendChild(isStr(e)?span({innerHTML:e}):e))),s.forEach((e=>e&&a.main.appendChild(isStr(e)?span({innerHTML:e}):e))),n.forEach((e=>e&&a.footer.appendChild(isStr(e)?span({innerHTML:e}):e))),o&&(a.dismissBtn=button({textContent:o,events:{click:e=>a.close()}},a.footer)),a}export function confirmPopup(e,s,n,o,t,p){const r=popup(e,s,button({textContent:n,events:{click:e=>{o(),r.close()}}}),t,p);return r}function handleEscapeUp(e){if("Escape"===e.key){const e=popups.at(-1);e?.dismissBtn&&e.close()}}document.addEventListener("keyup",handleEscapeUp);