import{newEl,button,isArr,isStr,span,isElement}from"./common.js";import styles from"./popup.css"with{type:"css"};document.adoptedStyleSheets.push(styles);var popups=[];export function popup(e,s,o,t,n,p={},i={}){i.className?p.className+=" modal":i.className="modal",Object.assign(i,{tag:"div"});const l=newEl(i,document.body),r=newEl(p,l);return popups.push(r),r.forceClose=()=>{popups=popups.filter((e=>e!==r)),l.remove()},r.close=()=>{if(r.onDismiss&&r.onDismiss())return!0;r.forceClose()},r.header=newEl({tag:"h3"},r),r.main=newEl({},r),r.footer=newEl({class:"flex-wrap"},r),r.onDismiss=n,isArr(e)||(e=[e]),isArr(s)||(s=[s]),isArr(o)||(o=[o]),e.forEach((e=>e&&r.header.appendChild(isElement(e)?e:newEl(e)))),s.forEach((e=>e&&r.main.appendChild(isElement(e)?e:newEl(e)))),o.forEach((e=>e&&r.footer.appendChild(isElement(e)?e:newEl(e)))),t&&(r.dismissBtn=button({textContent:t,events:{click:e=>r.close()}},r.footer)),r}export function confirmPopup(e,s,o,t,n,p){const i=popup(e,s,button({textContent:o,events:{click:e=>{t(),i.close()}}}),n,p);return i}function handleEscapeUp(e){if("Escape"===e.key){const e=popups.at(-1);e?.dismissBtn&&e.close()}}document.addEventListener("keyup",handleEscapeUp);